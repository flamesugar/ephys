<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ft_read_spikes_tdt</title>
  <meta name="keywords" content="ft_read_spikes_tdt">
  <meta name="description" content="data = ft_read_spikes_tdt(cfg)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">analysis</a> &gt; <a href="index.html">FT_integration</a> &gt; ft_read_spikes_tdt.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for analysis\FT_integration&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>ft_read_spikes_tdt
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>data = ft_read_spikes_tdt(cfg)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function data = ft_read_spikes_tdt(cfg) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> data = ft_read_spikes_tdt(cfg)

 Read continuous (LFP) data from TDT Tank and convert for use with
 FieldTrip toolbox

 cfg.tank     ...  Full path to tank and tank name is required if tank is
                   not registered.  If tank is registered, then just the
                   tank name is required.
    .block    ...  Scalar integer of a block number.  If not specified,
                   then a prompt will appear with a list of blocks from
                   the tank.
    .event    ...  Here, event is the name of the spike event such as
                   'Snip','eNeu','Spik',etc.. (default = 'eNeu')
    .sortname ...  Name of classification in OpenSorter (optional)

    .chremap  ...  Remap channels (optional)
 
 See also, <a href="trialfun_tdt.html" class="code" title="function [trl,event] = trialfun_tdt(cfg)">trialfun_tdt</a>

 DJS 2013</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="FTDataProcessing_SPIKES.html" class="code" title="">FTDataProcessing_SPIKES</a>	% Set some variables</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function data = ft_read_spikes_tdt(cfg)</a>
0002 <span class="comment">% data = ft_read_spikes_tdt(cfg)</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Read continuous (LFP) data from TDT Tank and convert for use with</span>
0005 <span class="comment">% FieldTrip toolbox</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% cfg.tank     ...  Full path to tank and tank name is required if tank is</span>
0008 <span class="comment">%                   not registered.  If tank is registered, then just the</span>
0009 <span class="comment">%                   tank name is required.</span>
0010 <span class="comment">%    .block    ...  Scalar integer of a block number.  If not specified,</span>
0011 <span class="comment">%                   then a prompt will appear with a list of blocks from</span>
0012 <span class="comment">%                   the tank.</span>
0013 <span class="comment">%    .event    ...  Here, event is the name of the spike event such as</span>
0014 <span class="comment">%                   'Snip','eNeu','Spik',etc.. (default = 'eNeu')</span>
0015 <span class="comment">%    .sortname ...  Name of classification in OpenSorter (optional)</span>
0016 <span class="comment">%</span>
0017 <span class="comment">%    .chremap  ...  Remap channels (optional)</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% See also, trialfun_tdt</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% DJS 2013</span>
0022 
0023 <span class="keyword">if</span> ~isfield(cfg,<span class="string">'tank'</span>),    error(<span class="string">'tank field is required for cfg'</span>);    <span class="keyword">end</span>
0024 <span class="keyword">if</span> ~isfield(cfg,<span class="string">'event'</span>),   cfg.event = <span class="string">'eNeu'</span>;     <span class="keyword">end</span>
0025 <span class="keyword">if</span> ~isfield(cfg,<span class="string">'chremap'</span>), cfg.chremap = [];       <span class="keyword">end</span>
0026 
0027 cfg.datatype = <span class="string">'BlockInfo'</span>;
0028 cfg.usemym   = false;
0029 <span class="keyword">if</span> ~isfield(cfg,<span class="string">'block'</span>) || isempty(cfg.block)
0030     tinfo = getTankData(cfg);
0031     <span class="keyword">if</span> isempty(tinfo)
0032         error(<span class="string">'No blocks found in ''%s'''</span>,tank)
0033     <span class="keyword">end</span>
0034     [sel,ok] = listdlg(<span class="string">'PromptString'</span>,<span class="string">'Select one block'</span>, <span class="keyword">...</span>
0035         <span class="string">'SelectionMode'</span>,<span class="string">'single'</span>, <span class="keyword">...</span>
0036         <span class="string">'ListString'</span>,num2cell([tinfo.block]));
0037     <span class="keyword">if</span> ~ok, <span class="keyword">return</span>; <span class="keyword">end</span>
0038     cfg.block = tinfo(sel).block;
0039 <span class="keyword">end</span>
0040 
0041 <span class="comment">% Read in Spike data from the tank</span>
0042 cfg.usemym      = false;
0043 cfg.datatype    = <span class="string">'Spikes'</span>;
0044 S = getTankData(cfg);
0045 
0046 <span class="keyword">if</span> isempty(cfg.chremap), cfg.chremap = 1:length(S); <span class="keyword">end</span>
0047 <span class="keyword">if</span> ~isequal(length(S),length(cfg.chremap))
0048     error(<span class="string">'The chremap was specified, but does not equal the number of channels in the recording'</span>)
0049 <span class="keyword">end</span>
0050 
0051 <span class="comment">% Create data structure</span>
0052 k = 1;
0053 <span class="keyword">for</span> i = 1:length(S)
0054     uscodes = unique(S(i).sortcode{1});
0055     <span class="keyword">if</span> isempty(uscodes), <span class="keyword">continue</span>; <span class="keyword">end</span>
0056     <span class="keyword">for</span> j = 1:length(uscodes)
0057         <span class="keyword">if</span> uscodes(j) == -1, <span class="keyword">continue</span>; <span class="keyword">end</span>
0058 <span class="comment">%             data.label{k} = sprintf('ch%02.0f_noise',S(i).channel);</span>
0059         data.label{k} = sprintf(<span class="string">'ch%02.0f_u%02.0f'</span>,S(i).channel,uscodes(j));
0060         ind = S(i).sortcode{1} == uscodes(j);
0061         data.timestamp{k}       = uint64(round(S(i).fsample*S(i).timestamps{1}(ind)'));
0062 <span class="comment">%         data.unit{i}            = S(i).sortcode{1}';</span>
0063         data.waveform{k}(1,:,:) = S(i).waveforms{1}';
0064         k = k + 1;
0065     <span class="keyword">end</span>
0066 <span class="keyword">end</span>
0067 data.dimord = <span class="string">'{chan}_lead_time_spike'</span>;
0068 
0069 <span class="comment">% generate a header</span>
0070 data.hdr.ADFrequency = S(1).fsample;
0071 data.hdr.NumDSPChannels = length(S);
0072 
0073 
0074 
0075 
0076 
0077 
0078 
0079 
0080 
0081 
0082 
0083 
0084 
0085 
0086 
0087 
0088 
0089 
0090 
0091</pre></div>
<hr><address>Generated on Wed 24-Jul-2013 19:48:12 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>