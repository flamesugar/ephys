<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of plot_LFP_rf</title>
  <meta name="keywords" content="plot_LFP_rf">
  <meta name="description" content="plot_LFP_rf(S,P,param,cfg)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">db</a> &gt; <a href="index.html">db_plotters</a> &gt; plot_LFP_rf.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for db\db_plotters&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>plot_LFP_rf
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>plot_LFP_rf(S,P,param,cfg)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function plot_LFP_rf(W,P,param,cfg) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> plot_LFP_rf(S,P,param,cfg)
 
 For use with DB_QuickPlot

 DJS 2013</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function plot_LFP_rf(W,P,param,cfg)</a>
0002 <span class="comment">% plot_LFP_rf(S,P,param,cfg)</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% For use with DB_QuickPlot</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% DJS 2013</span>
0007 win  = [cfg.win_on cfg.win_off] / 1000; <span class="comment">% ms -&gt; s</span>
0008 svec = floor(win(1)*P.wave_fs):round(win(2)*P.wave_fs);
0009 
0010 
0011 <span class="comment">% Organize by stimulus onsets</span>
0012 onsamp = round(P.VALS.onset * P.wave_fs);
0013 
0014 <span class="comment">% Reorganize by stimulus type</span>
0015 <span class="keyword">for</span> i = 1:length(param)
0016     stims{i} = P.lists.(param{i}); <span class="comment">%#ok&lt;AGROW&gt;</span>
0017 <span class="keyword">end</span>
0018 
0019 <span class="comment">% Won: {stim1 X stim2}(reps X samples)</span>
0020 Won = cell(length(stims{1}),length(stims{2}));
0021 <span class="keyword">for</span> i = 1:length(stims{1})
0022     <span class="keyword">for</span> j = 1:length(stims{2})
0023         ind = P.VALS.(param{1}) == stims{1}(i) <span class="keyword">...</span>
0024             &amp; P.VALS.(param{2}) == stims{2}(j);
0025         idx = find(ind);
0026         Won{i,j} = zeros(length(idx),length(svec));
0027         <span class="keyword">for</span> k = 1:length(idx)
0028             Won{i,j}(k,:) = W(onsamp(idx(k))+svec);
0029         <span class="keyword">end</span>
0030     <span class="keyword">end</span>
0031 <span class="keyword">end</span>
0032 
0033 mWon = cellfun(@mean,Won,<span class="string">'UniformOutput'</span>,false);
0034 rmsWon = cellfun(@(x) sqrt(mean(x.^2)),mWon,<span class="string">'UniformOutput'</span>,true)';
0035 
0036 <span class="comment">% post processing based on user options</span>
0037 <span class="keyword">if</span> isfield(cfg,<span class="string">'smooth2d'</span>) &amp;&amp; cfg.smooth2d, rmsWon = sgsmooth2d(rmsWon); <span class="keyword">end</span>
0038 <span class="keyword">if</span> isfield(cfg,<span class="string">'interpolate'</span>) &amp;&amp; cfg.interpolate &gt; 1
0039     rmsWon = interp2(rmsWon,cfg.interpolate);
0040     <span class="keyword">if</span> cfg.xislog
0041         stims{1} = logspace(log10(stims{1}(1)),log10(stims{1}(end)),size(rmsWon,2));
0042     <span class="keyword">else</span>
0043         stims{1} = linspace(stims{1}(1),stims{1}(end),size(rmsWon,2));
0044     <span class="keyword">end</span>
0045     stims{2} = linspace(stims{2}(1),stims{2}(end),size(rmsWon,1));
0046 <span class="keyword">end</span>
0047 
0048 set(gcf,<span class="string">'renderer'</span>,<span class="string">'zbuffer'</span>); <span class="comment">% OpenGL doesn't seem to like log axes</span>
0049 
0050 surf(stims{1},stims{2},rmsWon);
0051 view(2)
0052 <span class="keyword">if</span> isfield(cfg,<span class="string">'interpolate'</span>) &amp;&amp; cfg.interpolate &gt; 1 || isfield(cfg,<span class="string">'smooth2d'</span>) &amp;&amp; cfg.smooth2d
0053     shading interp
0054 <span class="keyword">else</span>
0055     shading flat
0056 <span class="keyword">end</span>
0057 <span class="keyword">if</span> cfg.xislog, set(gca,<span class="string">'xscale'</span>,<span class="string">'log'</span>); <span class="keyword">end</span>
0058 axis tight
0059 
0060 xlabel(param{1});
0061 ylabel(param{2});
0062 
0063 ax_data.mWon = mWon;
0064 ax_data.rmsWon = rmsWon;
0065 ax_data.x_axis = stims{1};
0066 ax_data.y_axis = stims{2};
0067 ax_data.P      = P;
0068 ax_data.cfg    = cfg;
0069 set(gca,<span class="string">'UserData'</span>,ax_data);
0070 
0071 
0072 
0073 
0074 
0075</pre></div>
<hr><address>Generated on Wed 24-Jul-2013 19:48:12 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>