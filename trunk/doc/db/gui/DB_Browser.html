<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of DB_Browser</title>
  <meta name="keywords" content="DB_Browser">
  <meta name="description" content="DB_Browser">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">db</a> &gt; <a href="index.html">gui</a> &gt; DB_Browser.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for db\gui&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>DB_Browser
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>DB_Browser</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function varargout = DB_Browser(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> DB_Browser

 Browses MySQL Electrophysiology database.

 See also, <a href="DB_UploadUtility.html" class="code" title="function varargout = DB_UploadUtility(varargin)">DB_UploadUtility</a>

 DJS 2013</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="DB_QuickPlot.html" class="code" title="function varargout = DB_QuickPlot(varargin)">DB_QuickPlot</a>	DB_QUICKPLOT MATLAB code for DB_QuickPlot.fig</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function DB_Browser_OpeningFcn(hObj, event, h, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = DB_Browser_OutputFcn(hObj, event, h)</a></li><li><a href="#_sub3" class="code">function closeme(hObj,h)</a></li><li><a href="#_sub4" class="code">function Connect2DB(h,dbpref,reg)</a></li><li><a href="#_sub5" class="code">function UpdateLists(hObj,h)</a></li><li><a href="#_sub6" class="code">function UpdatePrefs(ord,h)</a></li><li><a href="#_sub7" class="code">function val = GetListPref(ord,str)</a></li><li><a href="#_sub8" class="code">function ExcludeItem(hObj,h)</a></li><li><a href="#_sub9" class="code">function in_use = check_inuse(table,id,hObj)</a></li><li><a href="#_sub10" class="code">function get_protocol_Callback(h)</a></li><li><a href="#_sub11" class="code">function get_lfp_Callback(h)</a></li><li><a href="#_sub12" class="code">function get_spiketimes_Callback(h)</a></li><li><a href="#_sub13" class="code">function id = get_listid(hObj)</a></li><li><a href="#_sub14" class="code">function plot_unit_waveform(id,h)</a></li><li><a href="#_sub15" class="code">function LaunchParams(h)</a></li><li><a href="#_sub16" class="code">function LaunchPlot(h)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = DB_Browser(varargin)</a>
0002 <span class="comment">% DB_Browser</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Browses MySQL Electrophysiology database.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% See also, DB_UploadUtility</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% DJS 2013</span>
0009 
0010 <span class="comment">% Last Modified by GUIDE v2.5 04-Jan-2013 12:28:43</span>
0011 
0012 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0013 gui_Singleton = 1;
0014 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0015     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0016     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction DB_Browser_OpeningFcn(hObj, event, h, varargin) ">DB_Browser_OpeningFcn</a>, <span class="keyword">...</span>
0017     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = DB_Browser_OutputFcn(hObj, event, h)  ">DB_Browser_OutputFcn</a>, <span class="keyword">...</span>
0018     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0019     <span class="string">'gui_Callback'</span>,   []);
0020 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0021     gui_State.gui_Callback = str2func(varargin{1});
0022 <span class="keyword">end</span>
0023 
0024 <span class="keyword">if</span> nargout
0025     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0026 <span class="keyword">else</span>
0027     gui_mainfcn(gui_State, varargin{:});
0028 <span class="keyword">end</span>
0029 <span class="comment">% End initialization code - DO NOT EDIT</span>
0030 
0031 
0032 <span class="comment">% --- Executes just before DB_Browser is made visible.</span>
0033 <a name="_sub1" href="#_subfunctions" class="code">function DB_Browser_OpeningFcn(hObj, event, h, varargin) </a><span class="comment">%#ok&lt;INUSL&gt;</span>
0034 <span class="comment">% Choose default command line output for DB_Browser</span>
0035 h.output = hObj;
0036 
0037 <span class="comment">% Update h structure</span>
0038 guidata(hObj, h);
0039 
0040 <span class="comment">% UIWAIT makes DB_Browser wait for user response (see UIRESUME)</span>
0041 <span class="comment">% uiwait(h.DB_Browser);</span>
0042 
0043 
0044 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0045 <a name="_sub2" href="#_subfunctions" class="code">function varargout = DB_Browser_OutputFcn(hObj, event, h)  </a><span class="comment">%#ok&lt;INUSL&gt;</span>
0046 <span class="comment">% Get default command line output from h structure</span>
0047 varargout{1} = h.output;
0048 
0049 h.hierarchy = {<span class="string">'databases'</span>,<span class="string">'experiments'</span>,<span class="string">'tanks'</span>, <span class="keyword">...</span>
0050     <span class="string">'blocks'</span>,<span class="string">'channels'</span>,<span class="string">'units'</span>};
0051 guidata(h.DB_Browser,h);
0052 
0053 dbpref = getpref(<span class="string">'DB_Browser'</span>,<span class="string">'databases'</span>,[]);
0054 
0055 <a href="#_sub4" class="code" title="subfunction Connect2DB(h,dbpref,reg)">Connect2DB</a>(h,dbpref);
0056 
0057 
0058 <a name="_sub3" href="#_subfunctions" class="code">function closeme(hObj,h) </a><span class="comment">%#ok&lt;DEFNU&gt;</span>
0059 <span class="comment">% UpdatePrefs(h.hierarchy,h);</span>
0060 delete(hObj);
0061 
0062 
0063 
0064 
0065 
0066 
0067 
0068 
0069 
0070 <span class="comment">%% Database</span>
0071 
0072 <a name="_sub4" href="#_subfunctions" class="code">function Connect2DB(h,dbpref,reg)</a>
0073 <span class="keyword">if</span> nargin == 1, dbpref = []; <span class="keyword">end</span>
0074 
0075 <span class="keyword">if</span> nargin == 3 &amp;&amp; reg
0076     dbs = DB_Connect(true);
0077 <span class="keyword">elseif</span> ~myisopen <span class="comment">% if connection is lost, reconnect to database</span>
0078     dbs = DB_Connect;
0079 <span class="keyword">else</span>
0080     dbs = dblist;
0081 <span class="keyword">end</span>
0082 
0083 <span class="keyword">if</span> isempty(dbpref)
0084     i = get(h.popup_databases,<span class="string">'Value'</span>);
0085     dbpref = dbs{i};
0086 <span class="keyword">end</span>
0087 
0088 mym(<span class="string">'use'</span>,dbpref);
0089 
0090 i = find(ismember(dbs,dbpref));
0091 set(h.popup_databases,<span class="string">'String'</span>,dbs,<span class="string">'Value'</span>,i);
0092 
0093 <a href="#_sub5" class="code" title="subfunction UpdateLists(hObj,h)">UpdateLists</a>(h.popup_databases,h);
0094 
0095 <a name="_sub5" href="#_subfunctions" class="code">function UpdateLists(hObj,h)</a>
0096 ord = h.hierarchy;
0097 
0098 
0099 [~,str] = strtok(get(hObj,<span class="string">'tag'</span>),<span class="string">'_'</span>);
0100 str(1) = [];
0101 starth = find(strcmp(str,ord));
0102 
0103 <span class="keyword">if</span> strncmp(get(hObj,<span class="string">'tag'</span>),<span class="string">'showall'</span>,7)
0104     starth = starth - 1;
0105 <span class="keyword">end</span>
0106 
0107 set(h.DB_Browser,<span class="string">'Pointer'</span>,<span class="string">'watch'</span>); drawnow
0108 
0109 <a href="#_sub6" class="code" title="subfunction UpdatePrefs(ord,h)">UpdatePrefs</a>(ord(starth:end),h);
0110 
0111 <span class="keyword">for</span> i = starth:length(ord)
0112     <span class="keyword">if</span> strcmp(<span class="string">'databases'</span>,ord{i})
0113         lOrd = h.popup_databases;
0114     <span class="keyword">else</span>
0115         lOrd = h.([<span class="string">'list_'</span> ord{i}]);
0116     <span class="keyword">end</span>
0117     id = <a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(lOrd);
0118     
0119     <span class="keyword">if</span> isempty(id) &amp;&amp; i &gt; 1
0120         set(lOrd,<span class="string">'Value'</span>,1,<span class="string">'String'</span>,<span class="string">'&lt; NOTHING HERE &gt;'</span>);
0121         <span class="keyword">if</span> i &lt; length(ord)
0122             set(h.([<span class="string">'list_'</span> ord{i+1}]),<span class="string">'Value'</span>,1,<span class="string">'String'</span>,<span class="string">'&lt; NOTHING HERE &gt;'</span>);
0123         <span class="keyword">end</span>
0124         <span class="keyword">continue</span>
0125     <span class="keyword">end</span>
0126     
0127     <span class="keyword">if</span> i &lt; length(ord)
0128         
0129         <span class="comment">% THIS SEEMS KIND OF CLUMSY</span>
0130         saval = get(h.([<span class="string">'showall_'</span> ord{i+1}]),<span class="string">'Value'</span>);
0131         <span class="keyword">if</span> ~saval
0132             iustr = <span class="string">'AND in_use = TRUE'</span>;
0133         <span class="keyword">else</span>
0134             iustr = <span class="string">''</span>;
0135         <span class="keyword">end</span>
0136     <span class="keyword">end</span>
0137     
0138     <span class="keyword">if</span> ~isempty(id)
0139         <a href="#_sub9" class="code" title="subfunction in_use = check_inuse(table,id,hObj)">check_inuse</a>(ord{i},id,h.([<span class="string">'exclude_'</span> ord{i}]));
0140     <span class="keyword">end</span>
0141 
0142     <span class="keyword">switch</span> ord{i}
0143         <span class="keyword">case</span> <span class="string">'databases'</span>
0144             <span class="keyword">if</span> ~isempty(iustr), iustr = <span class="string">'WHERE in_use = TRUE'</span>; <span class="keyword">end</span>
0145             e = mym(<span class="string">'SELECT CONCAT(id,&quot;. &quot;,name) AS str FROM experiments {S}'</span>,iustr);
0146             
0147         <span class="keyword">case</span> <span class="string">'experiments'</span>
0148             e = mym([<span class="string">'SELECT CONCAT(id,&quot;. &quot;,tank_condition,&quot; [&quot;,name,&quot;]&quot;) '</span>, <span class="keyword">...</span>
0149                 <span class="string">'AS str FROM tanks WHERE exp_id = {Si} {S} '</span>, <span class="keyword">...</span>
0150                 <span class="string">'ORDER BY tank_condition'</span>],id,iustr);
0151             
0152         <span class="keyword">case</span> <span class="string">'tanks'</span>
0153             e = mym([<span class="string">'SELECT CONCAT(b.id,&quot;. &quot;,p.alias,&quot; [&quot;,b.block,&quot;]&quot;) '</span>, <span class="keyword">...</span>
0154                 <span class="string">'AS str FROM blocks b JOIN db_util.protocol_types p '</span>, <span class="keyword">...</span>
0155                 <span class="string">'ON b.protocol = p.pid WHERE b.tank_id = {Si} {S} '</span>, <span class="keyword">...</span>
0156                 <span class="string">'ORDER BY block'</span>],id,iustr);
0157             
0158         <span class="keyword">case</span> <span class="string">'blocks'</span>
0159             e = mym([<span class="string">'SELECT CONCAT(id,&quot;. &quot;,target,channel) AS str '</span>, <span class="keyword">...</span>
0160                 <span class="string">'FROM channels WHERE block_id = {Si} {S} ORDER BY channel'</span>],id,iustr);
0161             
0162         <span class="keyword">case</span> <span class="string">'channels'</span>
0163             e = mym([<span class="string">'SELECT CONCAT(u.id,&quot;. &quot;,p.class,&quot; (&quot;,u.unit_count,&quot;)&quot;) '</span>, <span class="keyword">...</span>
0164                 <span class="string">'AS str FROM units u JOIN class_lists.pool_class p '</span>, <span class="keyword">...</span>
0165                 <span class="string">'ON u.pool = p.id WHERE u.channel_id = {Si} {S} '</span>, <span class="keyword">...</span>
0166                 <span class="string">'ORDER BY p.id'</span>],id,iustr);
0167             
0168         <span class="keyword">case</span> <span class="string">'units'</span>
0169             setappdata(h.DB_Browser,ord{i},<a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(h.([<span class="string">'list_'</span> ord{i}])));
0170             <span class="keyword">continue</span>
0171     <span class="keyword">end</span>
0172     
0173     val = <a href="#_sub7" class="code" title="subfunction val = GetListPref(ord,str)">GetListPref</a>(ord{i+1},e.str);
0174     set(h.([<span class="string">'list_'</span> ord{i+1}]),<span class="string">'String'</span>,e.str,<span class="string">'Value'</span>,val);
0175     setappdata(h.DB_Browser,ord{i+1},<a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(h.([<span class="string">'list_'</span> ord{i+1}])));    
0176 <span class="keyword">end</span>
0177 
0178 <span class="keyword">for</span> i = 2:length(ord)
0179     setpref(<span class="string">'DB_BROWSER_SELECTION'</span>,ord{i},<a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(h.([<span class="string">'list_'</span> ord{i}])));
0180 <span class="keyword">end</span>
0181 
0182 <a href="#_sub14" class="code" title="subfunction plot_unit_waveform(id,h)">plot_unit_waveform</a>(id,h);
0183 
0184 <span class="comment">% update DB_QuickPlot</span>
0185 <span class="keyword">if</span> ~isempty(findobj(<span class="string">'name'</span>,<span class="string">'DB_QuickPlot'</span>))
0186     <a href="DB_QuickPlot.html" class="code" title="function varargout = DB_QuickPlot(varargin)">DB_QuickPlot</a>(@RefreshParameters);
0187 <span class="keyword">end</span>
0188 
0189 set(h.DB_Browser,<span class="string">'Pointer'</span>,<span class="string">'arrow'</span>);
0190 
0191 <a name="_sub6" href="#_subfunctions" class="code">function UpdatePrefs(ord,h)</a>
0192 vals = cell(size(ord));
0193 <span class="keyword">for</span> i = 1:length(ord)
0194     <span class="keyword">if</span> strcmp(<span class="string">'databases'</span>,ord{i})
0195         lOrd = h.popup_databases;
0196     <span class="keyword">else</span>
0197         lOrd = h.([<span class="string">'list_'</span> ord{i}]);
0198     <span class="keyword">end</span>
0199     rstr = get_string(lOrd);
0200     id = <a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(lOrd);
0201     
0202     <span class="keyword">switch</span> ord{i}
0203         <span class="keyword">case</span> <span class="string">'databases'</span>
0204             vals{i} = rstr;
0205         <span class="keyword">case</span> <span class="string">'experiments'</span>
0206             vals{i} = rstr;
0207         <span class="keyword">case</span> <span class="string">'tanks'</span>
0208             <span class="keyword">if</span> isempty(id), <span class="keyword">continue</span>; <span class="keyword">end</span>
0209             e = mym(<span class="string">'SELECT tank_condition FROM tanks WHERE id = {Si}'</span>,id);
0210             vals{i} = char(e.tank_condition);
0211         <span class="keyword">case</span> <span class="string">'blocks'</span>
0212             <span class="keyword">if</span> isempty(id), <span class="keyword">continue</span>; <span class="keyword">end</span>
0213             e = mym([<span class="string">'SELECT p.alias FROM blocks b '</span>, <span class="keyword">...</span>
0214                 <span class="string">'JOIN db_util.protocol_types p '</span>, <span class="keyword">...</span>
0215                 <span class="string">'ON b.protocol = p.pid WHERE b.id = {Si}'</span>],id);
0216             vals{i} = char(e.alias);
0217         <span class="keyword">case</span> <span class="string">'channels'</span>
0218             <span class="keyword">if</span> isempty(id), <span class="keyword">continue</span>; <span class="keyword">end</span>
0219             e = mym([<span class="string">'SELECT CONCAT(target,channel) AS str '</span>, <span class="keyword">...</span>
0220                 <span class="string">'FROM channels WHERE id = {Si}'</span>],id);
0221             vals{i} = char(e.str);
0222         <span class="keyword">case</span> <span class="string">'units'</span>
0223             <span class="keyword">if</span> isempty(id), <span class="keyword">continue</span>; <span class="keyword">end</span>
0224             e = mym([<span class="string">'SELECT p.class FROM units u '</span>, <span class="keyword">...</span>
0225                 <span class="string">'JOIN class_lists.pool_class p '</span>, <span class="keyword">...</span>
0226                 <span class="string">'ON u.pool = p.id WHERE u.id = {Si}'</span>],id);
0227             vals{i} = char(e.class);
0228     <span class="keyword">end</span>
0229 <span class="keyword">end</span>
0230 setpref(<span class="string">'DB_Browser'</span>,ord,vals);
0231 
0232 
0233 
0234 
0235 <a name="_sub7" href="#_subfunctions" class="code">function val = GetListPref(ord,str)</a>
0236 pref = getpref(<span class="string">'DB_Browser'</span>,ord,[]);
0237 val = 1;
0238 <span class="keyword">if</span> isempty(pref), <span class="keyword">return</span>; <span class="keyword">end</span>
0239 
0240 <span class="keyword">switch</span> ord
0241     <span class="keyword">case</span> {<span class="string">'databases'</span>, <span class="string">'experiments'</span>}
0242         <span class="keyword">return</span>
0243 
0244     <span class="keyword">otherwise</span>
0245         <span class="keyword">for</span> j = 1:length(str);
0246             instr = strfind(str{j},char(pref));
0247             <span class="keyword">if</span> instr
0248                 val = j;
0249                 <span class="keyword">break</span>
0250             <span class="keyword">end</span>
0251         <span class="keyword">end</span>
0252         
0253 <span class="keyword">end</span>
0254 
0255 <a name="_sub8" href="#_subfunctions" class="code">function ExcludeItem(hObj,h) </a><span class="comment">%#ok&lt;DEFNU&gt;</span>
0256 tag = get(hObj,<span class="string">'tag'</span>);
0257 table = tag(9:end); <span class="comment">% cut out 'exclude_' prefix</span>
0258 id = <a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(h.([<span class="string">'list_'</span> table]));
0259 DB_InUse(table,id,<span class="string">'toggle'</span>);
0260 <a href="#_sub5" class="code" title="subfunction UpdateLists(hObj,h)">UpdateLists</a>(hObj,h);
0261 
0262 <a name="_sub9" href="#_subfunctions" class="code">function in_use = check_inuse(table,id,hObj)</a>
0263 in_use = DB_InUse(table,id);
0264 <span class="keyword">if</span> in_use
0265     bgc = [0.941 0.941 0.941];
0266 <span class="keyword">else</span>
0267     bgc = [1 0.57 0.57];
0268 <span class="keyword">end</span>
0269 set(hObj,<span class="string">'BackgroundColor'</span>,bgc);
0270 
0271 
0272 
0273 
0274 
0275 
0276 <span class="comment">%% Get Data</span>
0277 <a name="_sub10" href="#_subfunctions" class="code">function get_protocol_Callback(h) </a><span class="comment">%#ok&lt;DEFNU&gt;</span>
0278 set(h.DB_Browser,<span class="string">'Pointer'</span>,<span class="string">'watch'</span>); drawnow
0279 id = <a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(h.list_blocks);
0280 params = DB_GetParams(id);
0281 assignin(<span class="string">'base'</span>,<span class="string">'params'</span>,params);
0282 fprintf(<span class="string">'Parameters structure in workspace: params\n'</span>)
0283 whos params
0284 set(h.DB_Browser,<span class="string">'Pointer'</span>,<span class="string">'arrow'</span>);
0285 
0286 <a name="_sub11" href="#_subfunctions" class="code">function get_lfp_Callback(h) </a><span class="comment">%#ok&lt;DEFNU&gt;</span>
0287 set(h.DB_Browser,<span class="string">'Pointer'</span>,<span class="string">'watch'</span>); drawnow
0288 id = <a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(h.list_channels);
0289 [lfp.wave,lfp.tvec] = DB_GetWave(id);
0290 assignin(<span class="string">'base'</span>,<span class="string">'lfp'</span>,lfp);
0291 fprintf(<span class="string">'LFP structure in workspace: lfp\n'</span>)
0292 whos lfp
0293 set(h.DB_Browser,<span class="string">'Pointer'</span>,<span class="string">'arrow'</span>);
0294 
0295 <a name="_sub12" href="#_subfunctions" class="code">function get_spiketimes_Callback(h) </a><span class="comment">%#ok&lt;DEFNU&gt;</span>
0296 set(h.DB_Browser,<span class="string">'Pointer'</span>,<span class="string">'watch'</span>); drawnow
0297 id = <a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(h.list_units);
0298 spiketimes = DB_GetSpiketimes(id);
0299 assignin(<span class="string">'base'</span>,<span class="string">'spiketimes'</span>,spiketimes);
0300 fprintf(<span class="string">'Spiketimes structure in workspace: spiketimes\n'</span>)
0301 whos spiketimes
0302 set(h.DB_Browser,<span class="string">'Pointer'</span>,<span class="string">'arrow'</span>);
0303 
0304 
0305 
0306 <span class="comment">%% Helper functions</span>
0307 
0308 <a name="_sub13" href="#_subfunctions" class="code">function id = get_listid(hObj)</a>
0309 <span class="comment">% get unique table id from list string</span>
0310 str = get_string(hObj);
0311 id  = str2num(strtok(str,<span class="string">'.'</span>));  <span class="comment">%#ok&lt;ST2NM&gt;</span>
0312 
0313 <a name="_sub14" href="#_subfunctions" class="code">function plot_unit_waveform(id,h)</a>
0314 cla(h.axes_unit,<span class="string">'reset'</span>);
0315 <span class="keyword">if</span> isempty(id), <span class="keyword">return</span>; <span class="keyword">end</span>
0316 e = mym(<span class="string">'SELECT * FROM units WHERE id = {Si}'</span>,id);
0317 w = str2num(char(e.pool_waveform{1}')); <span class="comment">%#ok&lt;ST2NM&gt;</span>
0318 s = str2num(char(e.pool_stddev{1}')); <span class="comment">%#ok&lt;ST2NM&gt;</span>
0319 fill([1:length(w) length(w):-1:1],[w+s fliplr(w-s)], <span class="keyword">...</span>
0320     [0.6 0.6 0.6],<span class="string">'Parent'</span>,h.axes_unit);
0321 hold(h.axes_unit,<span class="string">'on'</span>);
0322 plot(h.axes_unit,1:length(w),w,<span class="string">'-k'</span>,<span class="string">'LineWidth'</span>,2)
0323 hold(h.axes_unit,<span class="string">'off'</span>);
0324 axis(h.axes_unit,<span class="string">'tight'</span>);
0325 y = max(abs(ylim(h.axes_unit)));
0326 ylim(h.axes_unit,[-y y]);
0327 
0328 
0329 
0330 
0331 
0332 
0333 
0334 <span class="comment">%% External</span>
0335 <a name="_sub15" href="#_subfunctions" class="code">function LaunchParams(h)</a>
0336 block_id = <a href="#_sub13" class="code" title="subfunction id = get_listid(hObj)">get_listid</a>(h.list_blocks);
0337 DB_ParameterBreakout(block_id);
0338 
0339 <a name="_sub16" href="#_subfunctions" class="code">function LaunchPlot(h) </a><span class="comment">%#ok&lt;INUSD,DEFNU&gt;</span>
0340 <span class="comment">% f = DB_GenericPlot(true);</span>
0341 <span class="comment">% figure(f)</span>
0342 <a href="DB_QuickPlot.html" class="code" title="function varargout = DB_QuickPlot(varargin)">DB_QuickPlot</a>;
0343 
0344</pre></div>
<hr><address>Generated on Thu 11-Jul-2013 10:16:49 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>