<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of TDT_SetupRP</title>
  <meta name="keywords" content="TDT_SetupRP">
  <meta name="description" content="RP = TDT_SetupRP(mod,modid,ct,rpfile)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">TDTfun</a> &gt; TDT_SetupRP.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for TDTfun&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>TDT_SetupRP
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>RP = TDT_SetupRP(mod,modid,ct,rpfile)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = TDT_SetupRP(mod,modid,ct,rpfile) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> RP = TDT_SetupRP(mod,modid,ct,rpfile)
 [RP,status] = TDT_SetupRP( ...
 
 where mod is a valid module type: 'RZ5','RX6','RP2', etc..
   modid is the module id.  default is 1.
   ct is a connection type:  'GB' or 'USB'
   rpfile is the full path to an RPvds file.
 
 returns RP which is the handle to the RPco.x control.  Also returns
 status which is a bitmask of the module status.  Use with bitget function
   Bit# 0 = Connected
   Bit# 1 = Circuit loaded
   Bit# 2 = Circuit running
   Bit# 3 = RA16BA Battery
 (see page 43 of ActiveX reference manual for more status values).
 
 See also <a href="TDT_SetupDA.html" class="code" title="function varargout = TDT_SetupDA(tank)">TDT_SetupDA</a>, <a href="TDT_SetupTT.html" class="code" title="function [TT,tanks,TDTfig] = TDT_SetupTT(TT)">TDT_SetupTT</a>, bitget

 DJS (c) 2010</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = TDT_SetupRP(mod,modid,ct,rpfile)</a>
0002 <span class="comment">% RP = TDT_SetupRP(mod,modid,ct,rpfile)</span>
0003 <span class="comment">% [RP,status] = TDT_SetupRP( ...</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% where mod is a valid module type: 'RZ5','RX6','RP2', etc..</span>
0006 <span class="comment">%   modid is the module id.  default is 1.</span>
0007 <span class="comment">%   ct is a connection type:  'GB' or 'USB'</span>
0008 <span class="comment">%   rpfile is the full path to an RPvds file.</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% returns RP which is the handle to the RPco.x control.  Also returns</span>
0011 <span class="comment">% status which is a bitmask of the module status.  Use with bitget function</span>
0012 <span class="comment">%   Bit# 0 = Connected</span>
0013 <span class="comment">%   Bit# 1 = Circuit loaded</span>
0014 <span class="comment">%   Bit# 2 = Circuit running</span>
0015 <span class="comment">%   Bit# 3 = RA16BA Battery</span>
0016 <span class="comment">% (see page 43 of ActiveX reference manual for more status values).</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% See also TDT_SetupDA, TDT_SetupTT, bitget</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% DJS (c) 2010</span>
0021 
0022 
0023 <span class="keyword">if</span> isempty(modid), modid = 1; <span class="keyword">end</span>
0024 
0025 h = findobj(<span class="string">'Type'</span>,<span class="string">'figure'</span>,<span class="string">'-and'</span>,<span class="string">'Name'</span>,<span class="string">'RPfig'</span>);
0026 <span class="keyword">if</span> isempty(h)
0027     h = figure(<span class="string">'Visible'</span>,<span class="string">'off'</span>,<span class="string">'Name'</span>,<span class="string">'RPfig'</span>);
0028 <span class="keyword">end</span>
0029 
0030 RP = actxcontrol(<span class="string">'RPco.x'</span>,<span class="string">'parent'</span>,h);
0031 
0032 
0033 rpstatus = double(RP.GetStatus);
0034 <span class="keyword">if</span> all(bitget(rpstatus,1:3))
0035     fprintf(<span class="string">'RPco.X already connected, loaded, and running.\n'</span>)
0036     <span class="keyword">return</span>
0037 <span class="keyword">end</span>
0038 
0039 <span class="keyword">if</span> ischar(modid), modid = str2num(modid); <span class="keyword">end</span>
0040 
0041 <span class="keyword">if</span> ~eval(sprintf(<span class="string">'RP.Connect%s(''%s'',%d)'</span>,mod,ct,modid))
0042     errordlg(sprintf([<span class="string">'Unable to connect to %s module!\n\n'</span>, <span class="keyword">...</span>
0043         <span class="string">'Ensure all modules are powered on and connections are secured'</span>], <span class="keyword">...</span>
0044         mod,<span class="string">'Connection Error'</span>));
0045     delete(RP);
0046     close(h);
0047     RP = -1;
0048     
0049 <span class="keyword">else</span>
0050     fprintf(<span class="string">'%s_%d connected ... '</span>,mod,modid)
0051     RP.ClearCOF;
0052     <span class="keyword">if</span> ~isempty(rpfile)
0053         <span class="keyword">if</span> ~RP.LoadCOF(rpfile)
0054             errordlg(sprintf([<span class="string">'Unable to load RPvds file to %s module!\n\n'</span>, <span class="keyword">...</span>
0055                 <span class="string">'Ensure RPvds file is where it should be'</span>], <span class="keyword">...</span>
0056                 mod,<span class="string">'Loading Error'</span>));
0057         <span class="keyword">else</span>
0058             fprintf(<span class="string">'loaded ...'</span>)
0059             <span class="keyword">if</span> ~RP.Run
0060                 errordlg(sprintf([<span class="string">'Unable to run %s module!\n\n'</span>, <span class="keyword">...</span>
0061                     <span class="string">'Ensure all modules are powered on and connections are secured'</span>], <span class="keyword">...</span>
0062                     mod,<span class="string">'Run Error'</span>));
0063             <span class="keyword">else</span>
0064                 fprintf(<span class="string">'running\n'</span>)
0065             <span class="keyword">end</span>
0066         <span class="keyword">end</span>
0067     <span class="keyword">end</span>
0068 <span class="keyword">end</span>
0069 
0070 varargout{1} = RP;
0071 varargout{2} = double(RP.GetStatus);
0072 varargout{3} = h;
0073</pre></div>
<hr><address>Generated on Thu 11-Jul-2013 10:16:49 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>